<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Executor Parameters and Executor Parameter Traits</title>
<link rel="stylesheet" href="../../../src/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.78.1">
<link rel="home" href="../../../index.html" title="HPX 1.1.0">
<link rel="up" href="../parallel.html" title="High Level Parallel Facilities">
<link rel="prev" href="executors.html" title="Executors and Executor Traits">
<link rel="next" href="task_block.html" title="Using Task Blocks">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr><td valign="top"><img alt="HPX" width="536" height="100" src="../../../images/hpx_1_1_0.png"></td></tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="executors.html"><img src="../../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../parallel.html"><img src="../../../images/up.png" alt="Up"></a><a accesskey="h" href="../../../index.html"><img src="../../../images/home.png" alt="Home"></a><a accesskey="n" href="task_block.html"><img src="../../../images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="hpx.manual.parallel.executor_parameters"></a><a class="link" href="executor_parameters.html" title="Executor Parameters and Executor Parameter Traits">Executor Parameters
        and Executor Parameter Traits</a>
</h4></div></div></div>
<p>
          Executors as described in the previous section add a powerful customization
          capability to any facility which exposes management of parallel execution.
          However, sometimes it is necessary to be able to customize certain parameters
          of the execution as well. In <span class="emphasis"><em>HPX</em></span> we introduce the
          notion of execution parameters and execution parameter traits. At this
          point, the only parameter which can be customized is the size of the chunks
          of work executed on a single <span class="emphasis"><em>HPX</em></span>-thread (such as the
          number of loop iterations combined to run as a single task).
        </p>
<p>
          An executor parameter object is responsible for exposing the calculation
          of the size of the chunks scheduled. It abstracts the (potential platform-specific)
          algorithms of determining those chunks sizes.
        </p>
<p>
          The way executor parameters are implemented is aligned with the way executors
          are implemented. All functionalities of concrete executor parameter types
          are exposed and accessible through a corresponding <code class="computeroutput">hpx::parallel::executor_parameter_traits</code>
          type.
        </p>
<p>
          With <code class="computeroutput"><span class="identifier">executor_parameter_traits</span><span class="special">,</span></code> clients access all types of executor parameters
          uniformly:
        </p>
<pre class="programlisting"><span class="identifier">std</span><span class="special">::</span><span class="identifier">size_t</span> <span class="identifier">chunk_size</span> <span class="special">=</span>
    <span class="identifier">executor_parameter_traits</span><span class="special">&lt;</span><span class="identifier">my_parameter_t</span><span class="special">&gt;::</span><span class="identifier">get_chunk_size</span><span class="special">(</span><span class="identifier">my_parameter</span><span class="special">,</span>
        <span class="identifier">my_executor</span><span class="special">,</span> <span class="special">[](){</span> <span class="keyword">return</span> <span class="number">0</span><span class="special">;</span> <span class="special">},</span> <span class="identifier">num_tasks</span><span class="special">);</span>
</pre>
<p>
          This call synchronously retrieves the size of a single chunk of loop iterations
          (or similar) to combine for execution on a single <span class="emphasis"><em>HPX</em></span>-thread
          if the overall number of tasks to schedule is given by <code class="computeroutput"><span class="identifier">num_tasks</span></code>.
          The lambda function exposes a means of test-probing the execution of a
          single iteration for performance measurement purposes (the execution parameter
          type might dynamically determine the execution time of one or more tasks
          in order to calculate the chunk size, see <code class="computeroutput">hpx::parallel::auto_chunk_size</code> for an example
          of such a executor parameter type).
        </p>
<p>
          Other functions in the interface exist to discover whether a executor parameter
          type should be invoked once (i.e. returns a static chunk size, see <code class="computeroutput">hpx::parallel::static_chunk_size</code>)
          or whether it should be invoked for each scheduled chunk of work (i.e.
          it returns a variable chunk size, for an example, see <code class="computeroutput">hpx::parallel::guided_chunk_size</code>).
        </p>
<p>
          Though this interface appears to require executor parameter type authors
          to implement all different basic operations, there is really none required.
          In practice, all operations have sensible defaults. However, some executor
          parameter types will naturally specialize all operations for maximum efficiency.
        </p>
<p>
          In <span class="emphasis"><em>HPX</em></span> we have implemented the following executor
          parameter types:
        </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
              <code class="computeroutput">hpx::parallel::auto_chunk_size</code>:
              Loop iterations are divided into pieces and then assigned to threads.
              The number of loop iterations combined is determined based on measurements
              of how long the execution of 1% of the overall number of iterations
              takes. This executor parameters type makes sure that as many loop iterations
              are combined as necessary to run for the amount of time specified.
            </li>
<li class="listitem">
              <code class="computeroutput">hpx::parallel::static_chunk_size</code>: Loop
              iterations are divided into pieces of a given size and then assigned
              to threads. If the size is not specified, the iterations are evenly
              (if possible) divided contiguously among the threads. This executor
              parameters type is equivalent to OpenMP's STATIC scheduling directive.
            </li>
<li class="listitem">
              <code class="computeroutput">hpx::parallel::dynamic_chunk_size</code>: Loop
              iterations are divided into pieces of a given size and then dynamically
              scheduled among the cores; when an core finishes one chunk, it is dynamically
              assigned another If the size is not specified, the default chunk size
              is 1. This executor parameters type is equivalent to OpenMP's DYNAMIC
              scheduling directive.
            </li>
<li class="listitem">
              <code class="computeroutput">hpx::parallel::guided_chunk_size</code>: Iterations
              are dynamically assigned to cores in blocks as cores request them until
              no blocks remain to be assigned. Similar to <code class="computeroutput"><span class="identifier">dynamic_chunk_size</span></code>
              except that the block size decreases each time a number of loop iterations
              is given to a thread. The size of the initial block is proportional
              to <code class="computeroutput"><span class="identifier">number_of_iterations</span> <span class="special">/</span> <span class="identifier">number_of_cores</span></code>.
              Subsequent blocks are proportional to <code class="computeroutput"><span class="identifier">number_of_iterations_remaining</span>
              <span class="special">/</span> <span class="identifier">number_of_cores</span></code>.
              The optional chunk size parameter defines the minimum block size. The
              default minimal chunk size is 1. This executor parameters type is equivalent
              to OpenMP's GUIDED scheduling directive.
            </li>
</ul></div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2011-2018 The STE||AR Group
      (http://stellar-group.org)<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">LICENSE_1_0.txt</a>
        or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="executors.html"><img src="../../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../parallel.html"><img src="../../../images/up.png" alt="Up"></a><a accesskey="h" href="../../../index.html"><img src="../../../images/home.png" alt="Home"></a><a accesskey="n" href="task_block.html"><img src="../../../images/next.png" alt="Next"></a>
</div>
</body>
</html>
